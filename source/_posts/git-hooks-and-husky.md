---
title: Git Hooks ä¸ Husky
date: 2022-05-15 12:49:45
categories:
  - å‰ç«¯å¼€å‘
tags:
  - Git
  - Husky
---

å‰æ®µæ—¶é—´å­¦ä¹  [React](https://reactjs.org/) çš„æ—¶å€™å…¶å®å·²ç»ç”¨è¿‡ [Husky](https://reactjs.org/) äº†ï¼Œå½“æ—¶å°±åªæ˜¯çŸ¥é“å®ƒæ˜¯ä¸€ä¸ª Git Hooks ç®¡ç†å·¥å…·ï¼Œåæ­£èƒ½è·‘å°±è¡Œï¼Œä¹Ÿæ²¡æœ‰çº ç»“å…¶åŸç†ã€‚æœ€è¿‘ï¼Œåœ¨åˆ›å»º [Ant Design Pro](https://pro.ant.design/) é¡¹ç›®çš„æ—¶å€™ï¼Œä½¿ç”¨äº† [pnpm](https://pnpm.io/zh/) åŒ…ç®¡ç†å·¥å…·ï¼Œå‘ç°å®ƒè‡ªå¸¦çš„ [yorkie](https://www.npmjs.com/package/@umijs/yorkie) ä¸èƒ½æ­£å¸¸å®‰è£… Git Hooksï¼Œå°±æƒ³åˆ°äº†ä½¿ç”¨ Husky ä»£æ›¿ yorkieï¼Œé¡ºå¸¦å­¦ä¹ äº†ä¸€ä¸‹ Husky çš„å·¥ä½œè¿‡ç¨‹ï¼Œ ä¹Ÿç»™ Ant Design Pro æäº¤äº† [Pull Request](https://github.com/ant-design/ant-design-pro/pull/9718)ï¼Œå¹¶ä¸”é¡ºåˆ©åˆå¹¶äº† ğŸ‰ã€‚

## ä»€ä¹ˆæ˜¯ Git Hooks?

Git Hooks æ˜¯è¿è¡Œåœ¨ git æŒ‡ä»¤å„ä¸ªé˜¶æ®µçš„ shell è„šæœ¬ç‰‡æ®µï¼Œå¯ä»¥ç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œå…·ä½“ä¿¡æ¯è¯¦è§ï¼š [Git - Git é’©å­](https://git-scm.com/book/zh/v2/è‡ªå®šä¹‰-Git-Git-é’©å­)ã€‚Git åœ¨é»˜è®¤çŠ¶æ€ä¸‹ä¼šæ‰§è¡Œ `.git/hooks` ä¸­çš„ Hooksï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶ï¼Œ`.git` ä¸­çš„æ–‡ä»¶æ˜¯ä¸ä¼šè¢«åŠ å…¥åˆ°ç‰ˆæœ¬ç®¡ç†ä¸­ï¼Œå¦‚æœè¦éœ€è¦å›¢é˜Ÿåä½œï¼Œè¦æ±‚æ‰€æœ‰å›¢é˜Ÿæˆå‘˜åœ¨æäº¤ commit æ—¶ï¼Œç»Ÿä¸€æ‰§è¡Œä¸€æ®µç”¨äºè¯­æ³•æ£€æŸ¥æˆ–ä»£ç é£æ ¼æ£€æŸ¥çš„ä»£ç ï¼Œé‚£æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼Œæ¯•ç«Ÿä¸æ˜¯æ‰€æœ‰çš„å›¢é˜Ÿæˆå‘˜éƒ½ä¼šæ„¿æ„æˆ–è®°å¾—é…ç½® Git Hooks çš„ã€‚

### ä½¿ç”¨ Husky è‡ªåŠ¨é…ç½® Git Hooks

å…¶å® Git ä¸ºæˆ‘ä»¬æä¾›äº†é…ç½®æ–¹å¼ï¼Œé€šè¿‡ `git config core.hooksPath` å°±å¯ä»¥å°† hooks æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ç§»åŠ¨åˆ° `.git` æ–‡ä»¶å¤¹ä¹‹å¤–ï¼Œ Husky å°±æ˜¯ç”¨æ¥æ‰§è¡Œè¿™ä¸€æ“ä½œçš„ï¼Œæ‰§è¡Œå®Œ `husky install` ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°† Git Hooks ç¼–å†™åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ .husky æ–‡ä»¶å¤¹ä¸‹äº†ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å°† `husky install` æ·»åŠ åˆ° package.json çš„ prepare ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œè¿™æ ·æˆ‘ä»¬æ¯æ¬¡æ‰§è¡Œ `pnpm install` æ—¶ï¼ŒhooksPath å°±èƒ½è¢«è‡ªåŠ¨é…ç½®äº†ã€‚

```json
{
  "scripts": {
    "prepare": "husky install"
  },
  "devDependencies": {
    "husky": "^7.0.4"
  }
}
```
